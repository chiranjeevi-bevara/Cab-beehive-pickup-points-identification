{"paragraphs":[{"text":"import org.apache.spark._\r\nimport org.apache.spark.sql.SQLContext\r\nimport org.apache.spark.sql.types._\r\nimport org.apache.spark.sql.functions._\r\nimport org.apache.spark.sql._\r\nimport org.apache.spark.ml.feature.VectorAssembler\r\nimport org.apache.spark.ml.clustering.KMeans","user":"edureka_142337","dateUpdated":"2019-01-09T09:05:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark._\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql._\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.clustering.KMeans\n"}]},"apps":[],"jobName":"paragraph_1547024573143_1863277797","id":"20190109-090253_1715808349","dateCreated":"2019-01-09T09:02:53+0000","dateStarted":"2019-01-09T09:05:18+0000","dateFinished":"2019-01-09T09:05:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:62907"},{"text":"val sqlContext = new SQLContext(sc)\r\nimport sqlContext.implicits._\r\nimport sqlContext._","user":"edureka_142337","dateUpdated":"2019-01-09T09:05:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@29129111\nimport sqlContext.implicits._\nimport sqlContext._\n"}]},"apps":[],"jobName":"paragraph_1547024718441_-104511968","id":"20190109-090518_132194379","dateCreated":"2019-01-09T09:05:18+0000","dateStarted":"2019-01-09T09:05:34+0000","dateFinished":"2019-01-09T09:05:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62908"},{"text":"val schema = StructType(Array(StructField(\"dt\",StringType,true),\r\n     | StructField(\"lat\",DoubleType,true),\r\n     | StructField(\"lon\",DoubleType,true),\r\n     | StructField(\"base\",StringType,true)))","user":"edureka_142337","dateUpdated":"2019-01-09T09:05:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"schema: org.apache.spark.sql.types.StructType = StructType(StructField(dt,StringType,true), StructField(lat,DoubleType,true), StructField(lon,DoubleType,true), StructField(base,StringType,true))\n"}]},"apps":[],"jobName":"paragraph_1547024734085_220398349","id":"20190109-090534_325453382","dateCreated":"2019-01-09T09:05:34+0000","dateStarted":"2019-01-09T09:05:53+0000","dateFinished":"2019-01-09T09:05:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62909"},{"text":"val df = spark.read.option(\"header\",\"true\").schema(schema).csv(\"hdfs://nameservice1/user/edureka_142337/uber-raw-data-apr14.csv\")\r\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:06:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [dt: string, lat: double ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1547024753290_-1926085116","id":"20190109-090553_1148441124","dateCreated":"2019-01-09T09:05:53+0000","dateStarted":"2019-01-09T09:06:11+0000","dateFinished":"2019-01-09T09:06:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62910"},{"text":"df.cache","user":"edureka_142337","dateUpdated":"2019-01-09T09:06:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: df.type = [dt: string, lat: double ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1547024771737_1153090979","id":"20190109-090611_830483779","dateCreated":"2019-01-09T09:06:11+0000","dateStarted":"2019-01-09T09:06:21+0000","dateFinished":"2019-01-09T09:06:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62911"},{"text":"df.show\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:06:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+-------+--------+------+\n|              dt|    lat|     lon|  base|\n+----------------+-------+--------+------+\n|4/1/2014 0:11:00| 40.769|-73.9549|B02512|\n|4/1/2014 0:17:00|40.7267|-74.0345|B02512|\n|4/1/2014 0:21:00|40.7316|-73.9873|B02512|\n|4/1/2014 0:28:00|40.7588|-73.9776|B02512|\n|4/1/2014 0:33:00|40.7594|-73.9722|B02512|\n|4/1/2014 0:33:00|40.7383|-74.0403|B02512|\n|4/1/2014 0:39:00|40.7223|-73.9887|B02512|\n|4/1/2014 0:45:00| 40.762| -73.979|B02512|\n|4/1/2014 0:55:00|40.7524| -73.996|B02512|\n|4/1/2014 1:01:00|40.7575|-73.9846|B02512|\n|4/1/2014 1:19:00|40.7256|-73.9869|B02512|\n|4/1/2014 1:48:00|40.7591|-73.9684|B02512|\n|4/1/2014 1:49:00|40.7271|-73.9803|B02512|\n|4/1/2014 2:11:00|40.6463|-73.7896|B02512|\n|4/1/2014 2:25:00|40.7564|-73.9167|B02512|\n|4/1/2014 2:31:00|40.7666|-73.9531|B02512|\n|4/1/2014 2:43:00| 40.758|-73.9761|B02512|\n|4/1/2014 3:22:00|40.7238|-73.9821|B02512|\n|4/1/2014 3:35:00|40.7531|-74.0039|B02512|\n|4/1/2014 3:35:00|40.7389|-74.0393|B02512|\n+----------------+-------+--------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1547024781813_-950716006","id":"20190109-090621_1217265279","dateCreated":"2019-01-09T09:06:21+0000","dateStarted":"2019-01-09T09:06:31+0000","dateFinished":"2019-01-09T09:06:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62912"},{"text":"val featureCols = Array(\"lat\",\"lon\")","user":"edureka_142337","dateUpdated":"2019-01-09T09:06:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"featureCols: Array[String] = Array(lat, lon)\n"}]},"apps":[],"jobName":"paragraph_1547024791204_-478229033","id":"20190109-090631_1298850287","dateCreated":"2019-01-09T09:06:31+0000","dateStarted":"2019-01-09T09:06:54+0000","dateFinished":"2019-01-09T09:06:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62913"},{"text":"val assembler = new VectorAssembler().setInputCols(featureCols).setOutputCol(\"features\")\r\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:07:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"assembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_98c023fb9605\n"}]},"apps":[],"jobName":"paragraph_1547024814123_-1913110923","id":"20190109-090654_989462148","dateCreated":"2019-01-09T09:06:54+0000","dateStarted":"2019-01-09T09:07:10+0000","dateFinished":"2019-01-09T09:07:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62914"},{"text":"val df2 = assembler.transform(df)\r\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:07:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df2: org.apache.spark.sql.DataFrame = [dt: string, lat: double ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1547024830053_-1029696800","id":"20190109-090710_469237432","dateCreated":"2019-01-09T09:07:10+0000","dateStarted":"2019-01-09T09:07:24+0000","dateFinished":"2019-01-09T09:07:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62915"},{"text":"df2.show","user":"edureka_142337","dateUpdated":"2019-01-09T09:07:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+-------+--------+------+------------------+\n|              dt|    lat|     lon|  base|          features|\n+----------------+-------+--------+------+------------------+\n|4/1/2014 0:11:00| 40.769|-73.9549|B02512| [40.769,-73.9549]|\n|4/1/2014 0:17:00|40.7267|-74.0345|B02512|[40.7267,-74.0345]|\n|4/1/2014 0:21:00|40.7316|-73.9873|B02512|[40.7316,-73.9873]|\n|4/1/2014 0:28:00|40.7588|-73.9776|B02512|[40.7588,-73.9776]|\n|4/1/2014 0:33:00|40.7594|-73.9722|B02512|[40.7594,-73.9722]|\n|4/1/2014 0:33:00|40.7383|-74.0403|B02512|[40.7383,-74.0403]|\n|4/1/2014 0:39:00|40.7223|-73.9887|B02512|[40.7223,-73.9887]|\n|4/1/2014 0:45:00| 40.762| -73.979|B02512|  [40.762,-73.979]|\n|4/1/2014 0:55:00|40.7524| -73.996|B02512| [40.7524,-73.996]|\n|4/1/2014 1:01:00|40.7575|-73.9846|B02512|[40.7575,-73.9846]|\n|4/1/2014 1:19:00|40.7256|-73.9869|B02512|[40.7256,-73.9869]|\n|4/1/2014 1:48:00|40.7591|-73.9684|B02512|[40.7591,-73.9684]|\n|4/1/2014 1:49:00|40.7271|-73.9803|B02512|[40.7271,-73.9803]|\n|4/1/2014 2:11:00|40.6463|-73.7896|B02512|[40.6463,-73.7896]|\n|4/1/2014 2:25:00|40.7564|-73.9167|B02512|[40.7564,-73.9167]|\n|4/1/2014 2:31:00|40.7666|-73.9531|B02512|[40.7666,-73.9531]|\n|4/1/2014 2:43:00| 40.758|-73.9761|B02512| [40.758,-73.9761]|\n|4/1/2014 3:22:00|40.7238|-73.9821|B02512|[40.7238,-73.9821]|\n|4/1/2014 3:35:00|40.7531|-74.0039|B02512|[40.7531,-74.0039]|\n|4/1/2014 3:35:00|40.7389|-74.0393|B02512|[40.7389,-74.0393]|\n+----------------+-------+--------+------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1547024844533_523949907","id":"20190109-090724_1369327557","dateCreated":"2019-01-09T09:07:24+0000","dateStarted":"2019-01-09T09:07:33+0000","dateFinished":"2019-01-09T09:07:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62916"},{"text":"val Array(trainingData, testData) = df2.randomSplit(Array(0.7,0.3),5043)","user":"edureka_142337","dateUpdated":"2019-01-09T09:07:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"trainingData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [dt: string, lat: double ... 3 more fields]\ntestData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [dt: string, lat: double ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1547024853806_-1380172400","id":"20190109-090733_1485376918","dateCreated":"2019-01-09T09:07:33+0000","dateStarted":"2019-01-09T09:07:49+0000","dateFinished":"2019-01-09T09:07:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62917"},{"text":"val kmeans = new KMeans().setK(8).setFeaturesCol(\"features\").setPredictionCol(\"prediction\")\r\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:08:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"kmeans: org.apache.spark.ml.clustering.KMeans = kmeans_8303f627b2c3\n"}]},"apps":[],"jobName":"paragraph_1547024869422_-105267786","id":"20190109-090749_635998876","dateCreated":"2019-01-09T09:07:49+0000","dateStarted":"2019-01-09T09:08:03+0000","dateFinished":"2019-01-09T09:08:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62918"},{"text":"val model = kmeans.fit(df2)","user":"edureka_142337","dateUpdated":"2019-01-09T09:08:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"model: org.apache.spark.ml.clustering.KMeansModel = kmeans_8303f627b2c3\n"}]},"apps":[],"jobName":"paragraph_1547024882948_-1962065978","id":"20190109-090802_1325348000","dateCreated":"2019-01-09T09:08:02+0000","dateStarted":"2019-01-09T09:08:18+0000","dateFinished":"2019-01-09T09:08:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62919"},{"text":"println(\"Final centres:\")\r\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:08:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Final centres:\n"}]},"apps":[],"jobName":"paragraph_1547024898038_-641577105","id":"20190109-090818_2070617170","dateCreated":"2019-01-09T09:08:18+0000","dateStarted":"2019-01-09T09:08:38+0000","dateFinished":"2019-01-09T09:08:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62920"},{"text":"model.clusterCenters.foreach(println)\r\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:08:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[40.97222233300098,-73.61633838484539]\n[40.7005666117744,-74.20165533141227]\n[40.78196746555517,-73.95896720977888]\n[40.65587029001176,-73.77950754744002]\n[40.72763839578744,-74.00037002281103]\n[40.68794218679241,-73.96472001742431]\n[40.781471330793366,-73.87032514581611]\n[40.75576357896371,-73.98138834987272]\n"}]},"apps":[],"jobName":"paragraph_1547024917894_1439575668","id":"20190109-090837_1480867792","dateCreated":"2019-01-09T09:08:37+0000","dateStarted":"2019-01-09T09:08:52+0000","dateFinished":"2019-01-09T09:08:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62921"},{"text":"val categories = model.transform(testData)\r\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:09:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"categories: org.apache.spark.sql.DataFrame = [dt: string, lat: double ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1547024931969_-556300767","id":"20190109-090851_2071309499","dateCreated":"2019-01-09T09:08:51+0000","dateStarted":"2019-01-09T09:09:16+0000","dateFinished":"2019-01-09T09:09:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62922"},{"text":"categories.show","user":"edureka_142337","dateUpdated":"2019-01-09T09:09:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+-------+--------+------+------------------+----------+\n|              dt|    lat|     lon|  base|          features|prediction|\n+----------------+-------+--------+------+------------------+----------+\n|4/1/2014 0:00:00|40.7188|-73.9863|B02598|[40.7188,-73.9863]|         4|\n|4/1/2014 0:01:00|40.7355|-73.9966|B02617|[40.7355,-73.9966]|         4|\n|4/1/2014 0:02:00|40.7556|-73.9874|B02598|[40.7556,-73.9874]|         7|\n|4/1/2014 0:04:00|40.7153|-73.9666|B02682|[40.7153,-73.9666]|         5|\n|4/1/2014 0:11:00| 40.769|-73.9549|B02512| [40.769,-73.9549]|         2|\n|4/1/2014 0:16:00|40.7748| -73.954|B02598| [40.7748,-73.954]|         2|\n|4/1/2014 0:22:00|40.7141|-74.0148|B02598|[40.7141,-74.0148]|         4|\n|4/1/2014 0:24:00|40.7613|-73.9788|B02682|[40.7613,-73.9788]|         7|\n|4/1/2014 0:25:00|40.6483|-73.7826|B02598|[40.6483,-73.7826]|         3|\n|4/1/2014 0:25:00|40.7095|-74.0107|B02682|[40.7095,-74.0107]|         4|\n|4/1/2014 0:26:00|40.7589|-73.9839|B02682|[40.7589,-73.9839]|         7|\n|4/1/2014 0:27:00|40.7362|-73.9768|B02617|[40.7362,-73.9768]|         7|\n|4/1/2014 0:28:00|40.7405|-74.0057|B02682|[40.7405,-74.0057]|         4|\n|4/1/2014 0:28:00|40.7588|-73.9776|B02512|[40.7588,-73.9776]|         7|\n|4/1/2014 0:31:00|40.7022|-73.7786|B02682|[40.7022,-73.7786]|         3|\n|4/1/2014 0:31:00|40.7641| -73.976|B02598| [40.7641,-73.976]|         7|\n|4/1/2014 0:32:00|40.6545|-73.9619|B02617|[40.6545,-73.9619]|         5|\n|4/1/2014 0:33:00|40.7383|-74.0403|B02512|[40.7383,-74.0403]|         4|\n|4/1/2014 0:35:00|40.7078| -74.012|B02682| [40.7078,-74.012]|         4|\n|4/1/2014 0:38:00| 40.739|-74.0396|B02682| [40.739,-74.0396]|         4|\n+----------------+-------+--------+------+------------------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1547024956792_-1406180439","id":"20190109-090916_1668332502","dateCreated":"2019-01-09T09:09:16+0000","dateStarted":"2019-01-09T09:09:27+0000","dateFinished":"2019-01-09T09:09:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62923"},{"text":"categories.select(hour($\"dt\").alias(\"hour\"),$\"prediction\").groupBy(\"hour\",\"prediction\").agg(count(\"prediction\").alias(\"count\")).orderBy(desc(\"count\")).show","user":"edureka_142337","dateUpdated":"2019-01-09T09:09:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+----------+-----+\n|hour|prediction|count|\n+----+----------+-----+\n|null|         4|61980|\n|null|         7|57598|\n|null|         2|21248|\n|null|         5|17209|\n|null|         6| 5023|\n|null|         3| 4226|\n|null|         1| 1451|\n|null|         0|  264|\n+----+----------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1547024967199_-1743574576","id":"20190109-090927_1648157671","dateCreated":"2019-01-09T09:09:27+0000","dateStarted":"2019-01-09T09:09:41+0000","dateFinished":"2019-01-09T09:09:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62924"},{"text":"categories.groupBy(\"prediction\").count().show()\r\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:10:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+-----+\n|prediction|count|\n+----------+-----+\n|         1| 1451|\n|         6| 5023|\n|         3| 4226|\n|         5|17209|\n|         4|61980|\n|         7|57598|\n|         2|21248|\n|         0|  264|\n+----------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1547024981738_1771506700","id":"20190109-090941_959645563","dateCreated":"2019-01-09T09:09:41+0000","dateStarted":"2019-01-09T09:10:02+0000","dateFinished":"2019-01-09T09:10:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62925"},{"text":"z.show(categories.select(hour($\"dt\").alias(\"hour\"), $\"prediction\").groupBy(\"hour\",\"prediction\").agg(count(\"prediction\").alias(\"count\")).orderBy(\"hour\",\"prediction\"))","user":"edureka_142337","dateUpdated":"2019-01-09T09:16:13+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hour\tprediction\tcount\nnull\t0\t264\nnull\t1\t1451\nnull\t2\t21248\nnull\t3\t4226\nnull\t4\t61980\nnull\t5\t17209\nnull\t6\t5023\nnull\t7\t57598\n"}]},"apps":[],"jobName":"paragraph_1547025002774_414097780","id":"20190109-091002_1321400881","dateCreated":"2019-01-09T09:10:02+0000","dateStarted":"2019-01-09T09:15:41+0000","dateFinished":"2019-01-09T09:15:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62926"},{"text":"%sql select hour(uber.dt) as hr, prediction, count(uber.prediction) as ct from uber groupby hour(uber.dt), prediction order by count(uber.prediction) desc","user":"edureka_142337","dateUpdated":"2019-01-09T09:20:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"\nmismatched input 'hour' expecting {<EOF>, ',', 'WHERE', 'GROUP', 'ORDER', 'HAVING', 'LIMIT', 'JOIN', 'CROSS', 'INNER', 'LEFT', 'RIGHT', 'FULL', 'NATURAL', 'LATERAL', 'WINDOW', 'UNION', 'EXCEPT', 'MINUS', 'INTERSECT', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'ANTI'}(line 1, pos 87)\n\n== SQL ==\nselect hour(uber.dt) as hr, prediction, count(uber.prediction) as ct from uber groupby hour(uber.dt), prediction order by count(uber.prediction) desc\n---------------------------------------------------------------------------------------^^^\n\nset zeppelin.spark.sql.stacktrace = true to see full stacktrace"}]},"apps":[],"jobName":"paragraph_1547025341551_-824133095","id":"20190109-091541_1421026251","dateCreated":"2019-01-09T09:15:41+0000","dateStarted":"2019-01-09T09:20:35+0000","dateFinished":"2019-01-09T09:20:35+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:62927"},{"text":"df.registerTempTable(\"uber\")","user":"edureka_142337","dateUpdated":"2019-01-09T09:23:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1547025634922_689882831","id":"20190109-092034_535845112","dateCreated":"2019-01-09T09:20:34+0000","dateStarted":"2019-01-09T09:23:12+0000","dateFinished":"2019-01-09T09:23:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62928"},{"text":"","user":"edureka_142337","dateUpdated":"2019-01-09T09:26:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"cannot resolve '`prediction`' given input columns: [dt, lat, lon, base]; line 1 pos 103;\n'Sort ['count('uber.prediction) DESC NULLS LAST], true\n+- 'Aggregate [hour(cast(dt#0 as timestamp)), 'prediction], [hour(cast(dt#0 as timestamp)) AS hr#285, 'prediction, 'count('uber.prediction) AS ct#286]\n   +- SubqueryAlias uber\n      +- Relation[dt#0,lat#1,lon#2,base#3] csv\n\nset zeppelin.spark.sql.stacktrace = true to see full stacktrace"}]},"apps":[],"jobName":"paragraph_1547025792317_-1139599833","id":"20190109-092312_846018887","dateCreated":"2019-01-09T09:23:12+0000","dateStarted":"2019-01-09T09:24:12+0000","dateFinished":"2019-01-09T09:24:12+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:62929"},{"text":"categories.registerTempTable(\"uber\")\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:25:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1547025852482_1307326551","id":"20190109-092412_1679352316","dateCreated":"2019-01-09T09:24:12+0000","dateStarted":"2019-01-09T09:25:58+0000","dateFinished":"2019-01-09T09:25:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62930"},{"text":"%sql select hour(uber.dt) as hr, prediction, count(uber.prediction) as ct from uber group by hour(uber.dt), prediction order by count(uber.prediction) desc\r\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:26:49+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hr\tprediction\tct\nnull\t4\t61980\nnull\t7\t57598\nnull\t2\t21248\nnull\t5\t17209\nnull\t6\t5023\nnull\t3\t4226\nnull\t1\t1451\nnull\t0\t264\n"}]},"apps":[],"jobName":"paragraph_1547025941809_-1179366888","id":"20190109-092541_1602967675","dateCreated":"2019-01-09T09:25:41+0000","dateStarted":"2019-01-09T09:26:35+0000","dateFinished":"2019-01-09T09:26:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62931"},{"text":"%sql select prediction, count(prediction) as count from uber group by prediction\n\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:28:22+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\tcount\n1\t1451\n6\t5023\n3\t4226\n5\t17209\n4\t61980\n7\t57598\n2\t21248\n0\t264\n"}]},"apps":[],"jobName":"paragraph_1547025995498_1571480479","id":"20190109-092635_1989610063","dateCreated":"2019-01-09T09:26:35+0000","dateStarted":"2019-01-09T09:28:03+0000","dateFinished":"2019-01-09T09:28:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62932"},{"text":"%sql\n","user":"edureka_142337","dateUpdated":"2019-01-09T09:28:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1547026083341_-1084739439","id":"20190109-092803_2078445844","dateCreated":"2019-01-09T09:28:03+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:62933"}],"name":"Uberfinal","id":"2DZVGZE61","angularObjects":{"2CZJM6CCF:shared_process":[],"2CZKTMK5W:shared_process":[],"2CYU1EQZQ:shared_process":[],"2D2N58VNT:shared_process":[],"2CZFY7FU3:shared_process":[],"2CZZK92MQ:shared_process":[],"2D369VJ8U:shared_process":[],"2D28FF2XF:shared_process":[],"2D1P53WWU:shared_process":[],"2D2Q1AJPD:shared_process":[],"2D31A95BZ:shared_process":[],"2CYY5K9XQ:shared_process":[],"2D264X7RK:edureka_142337:":[],"2DMM9PGYE:shared_process":[],"2D11N7PRP:shared_process":[],"2D1XNRJHX:shared_process":[],"2CZJE853H:shared_process":[],"2CZDWMJP9:shared_process":[],"2D1YK3122:shared_process":[],"2CYHWZJ6N:shared_process":[],"2D2BPUU4J:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}